
<!-- blog/templates/blog/post_detail.html -->
{% extends 'blog/base.html' %}

{% block content %}
<article class="post">
    <h2>{{ post.title }}</h2>
    <p>作者: {{ post.author.username }} | 发布时间: {{ post.created_at|date:"Y-m-d H:i" }}</p>
    <div>{{ post.content|linebreaks }}</div>
</article>

<section class="comments">
    <h3>评论 ({{ post.comments.count }})</h3>
    
    {% for comment in post.comments.all %}
        {% if comment.approved %}
        <div class="comment">
            <strong>{{ comment.author }}</strong>
            <span>{{ comment.created_at|date:"Y-m-d H:i" }}</span>
            <p>{{ comment.content }}</p>
        </div>
        {% endif %}
    {% endfor %}
    
    <h4>添加评论</h4>
    <form method="post" action="{% url 'add_comment' post.pk %}">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <button type="submit">提交评论</button>
    </form>
</section>
{% endblock %}